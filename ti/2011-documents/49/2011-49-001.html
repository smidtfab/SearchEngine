<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="description" content="for those who use the Recaptcha system, here's a class you can use. All of the code is directly from the Recaptcha website, just cleaned up into a sta" />
  <meta name="keywords" content="programming, code, repository, organize, share, store, source code, html, Snipplr, TextMate" />
  <title>Recaptcha OOP Class - PHP - Snipplr Social Snippet Repository</title>
  <link rel="search" type="application/opensearchdescription+xml" title="Snipplr" href="/snipplrsearch.xml" />
  <link rel="stylesheet" type="text/css" href="/css/reset-min.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="/css/fonts-min.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="/css/minimal.css?r202" media="screen" title="small" />
  <link rel="alternate stylesheet" type="text/css" href="/css/main.css?r203" media="screen" title="big" />
  <link rel="stylesheet" type="text/css" href="/css/language-articles.css" media="screen" />
  <link rel="stylesheet" type="text/css" href="/css/gigs.css" media="screen" />

  <!--[if lte IE 6]><link rel="stylesheet" type="text/css" href="/css/ie.css"/><![endif]-->
  <!--[if IE 7]><link rel="stylesheet" type="text/css" href="/css/ie7.css"/><![endif]-->
  <link rel="shortcut icon" href="/images/favicon.ico" />
  <link rel="alternate" type="application/rss+xml" title="Snippet comments" href="/rss/comments/25680/" />
  <!--[if lte IE 6]><script src="http://www.savethedevelopers.org/say.no.to.ie.6.js"></script><![endif]-->
  <script src="/js/prototype.js" type="text/javascript" language="javascript" charset="utf-8"></script>
  <script src="/js/scriptaculous.js" type="text/javascript" charset="utf-8"></script>
  <script src="/js/jquery-1.4.2.min.js" type="text/javascript" language="javascript" charset="utf-8"></script>
  <!--<script src="/js/jquery-ui-1.8.2.custom.min.js" type="text/javascript" language="javascript" charset="utf-8"></script>-->
  <script src="/js/snipplr.js?20080408" type="text/javascript" language="javascript" charset="utf-8"></script>
  <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
  <script src="/js/styleswitcher.js" type="text/javascript" charset="utf-8"></script>
    </head>

<body id="snippets">

<div id="top-banner">
  <a href="http://codecanyon.net?ref=snipplr"><img src="/images/ads/codecanyon_ad.jpg" /></a></div>

<div id="header">
  <div class="container">
    <a id="logo" href="/"></a>

    <div id="nav">
      <ul>
        <li class="snippets">
          <a href="/">code snippets</a>

                    <ul class="secondary">
            <li><a href="/all/">all code snippets</a>/</li>

                        <li><a href="/popular/">popular code snippets</a>/</li>

            <li><a href="/yours/">your code snippets</a></li>

                      </ul>
                  </li>
        <li class="developer">
          <a href="/developer/">extras</a>
                  </li>

        <li class="blog"><a href="/blog/">blog</a></li>

        <li class="about"><a href="/about/">about snipplr</a></li>

      </ul>
    </div>
  </div>
</div>
<div id="subnav">
  <div class="container">
    <div id="switcher">
      <span>Change style:</span>
      <ul>
        <li><a class="styleswitch" href="#" onclick="setActiveStyleSheet('big'); return false;">Big</a> / </li>
        <li><a class="styleswitch" href="#" onclick="setActiveStyleSheet('small'); return false;">Small</a></li>
      </ul>
    </div>
    <ul>
          <li><a href="/new/" class="first">New Snippet</a>/</li>
    
    
                  <li><a href="/register/">Register</a>/</li>
        <li><a href="/login/">Login</a></li>
              </ul>
  </div>
</div>

<div id="stripe">
  <div class="container">
      <form name="search" action="/search.php" method="get" accept-charset="utf-8" class="search">
      <p>
        <input type="text" name="q" value="search" id="search" onclick="clearOnce();" />
                  <input type="submit" name="btnsearch" value="go" class="submit-min" />
                <a href="/search.php?advanced" class="advsearch"><strong>advanced code snippet search</strong></a>
      </p>
    </form>
    </div>
</div>
	<!-- main content area of site -->
		<div id="body">
			<div class="container">
				<div id="sidecol">

									<h2>Posted By</h2>
					<p><a href='/users/MMDeveloper/'>MMDeveloper</a> on 12/29/09</p>
					<br/>

					<h2>Tagged</h2>
					<p><a href='/users/MMDeveloper/tags/recaptcha/'>recaptcha</a> </p>
					<br/>

					<h2>Versions (<a href='/faq/'>?</a>)</h2>
					<p><select name='pversion' id='pversion' onchange='versionjump(25680, this.value)'><option value='32167' selected>12/29/09 01:57pm</option></select> <!--<a href='/view/25680.32167/?deleteRevision'>delete revision</a>--></p>

					
					

				</div>

				<div id="maincol">
					<div class="post">
						<h1>Recaptcha OOP Class</h1>

																	</div>
					<hr class="dotted" />

					<p class="nomarg"><span class="rgt">Published in: <a href="/all/language/PHP">PHP</a></span>&nbsp;</p>
					<hr class="dotted marg" />

					<p>URL: <a href='http://skyward.nefec.org' rel='external nofollow'>http://skyward.nefec.org</a></p>					<div class="description"><p>for those who use the Recaptcha system, here's a class you can use. All of the code is directly from the Recaptcha website, just cleaned up into a stand-alone class.</p>
</div>

					<div id="viewsource">
											<div class="sourcenav"><span class="rgt">

<a href="javascript:expand();" id="toggleexpand">Expand</a> | <!-- / <a href="javascript:wraplines();">Wrap</a> -->

<a href="#" onclick="$('embed_div').toggle();$('embed_code').focus();$('embed_code').select();return false;">Embed</a> | <a rel="nofollow" href="/view.php?codeview&amp;id=25680">Plain Text</a></span>
<br />
</div>
						<div id="innersource" class="nowrap">
							<div style="display:none;float:right;color:black;" id="embed_div"><input style="border:2px solid #3299C6;padding:1px"id="embed_code" readonly="1" type="text" value="&lt;div id=&quot;snipplr_embed_25680&quot; class=&quot;snipplr_embed&quot;&gt;&lt;a href=&quot;http://snipplr.com/view/25680/recaptcha-oop-class/&quot;&gt;Code snippet - Recaptcha OOP Class&lt;/a&gt; on Snipplr&lt;/div&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://snipplr.com/js/embed.js&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://snipplr.com/json/25680&quot;&gt;&lt;/script&gt;" onclick="this.select();" size="35" /><br /><em>Copy this code and paste it in your HTML</em></div>
							<pre class="php php" style="font-family:monospace;"><ol><li class="li1"><div class="de1"><span class="kw2">&lt;?php</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">/*</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">	Be sure to set the public and private keys</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">*/</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="kw2">class</span> recaptcha <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">	<span class="kw2">private</span>		<span class="re0">$serverURLS</span>		<span class="sy0">=</span>	<span class="kw2">NULL</span>;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span>		<span class="re0">$ReCaptchaResponse</span>	<span class="sy0">=</span>	<span class="kw2">NULL</span>;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span>		<span class="re0">$keys</span>			<span class="sy0">=</span>	<span class="kw2">NULL</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">function</span> __construct<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span> <span class="sy0">=</span> <span class="kw2">new</span> stdClass<span class="br0">&#40;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span><span class="sy0">-&gt;</span><span class="me1">RECAPTCHA_API_SERVER</span> <span class="sy0">=</span> <span class="st0">&quot;http://api.recaptcha.net&quot;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span><span class="sy0">-&gt;</span><span class="me1">RECAPTCHA_API_SECURE_SERVER</span> <span class="sy0">=</span> <span class="st0">&quot;https://api-secure.recaptcha.net&quot;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span><span class="sy0">-&gt;</span><span class="me1">RECAPTCHA_VERIFY_SERVER</span> <span class="sy0">=</span> <span class="st0">&quot;api-verify.recaptcha.net&quot;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span> <span class="sy0">=</span> <span class="kw2">new</span> stdClass<span class="br0">&#40;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">is_valid</span> <span class="sy0">=</span> <span class="kw2">NULL</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">error</span> <span class="sy0">=</span> <span class="kw2">NULL</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span> <span class="sy0">=</span> <span class="kw2">new</span> stdClass<span class="br0">&#40;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">=</span> <span class="st0">&quot;6LcJOQkAAAAAABi3XIlSazOJTxbUNiVfQ0dkXAOT &quot;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">privatek</span> <span class="sy0">=</span> <span class="st0">&quot;INSERT YOUR PRIVATE KEY HERE&quot;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">=</span> <span class="st0">&quot;INSERT YOUR PUBLIC KEY HERE&quot;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">privatek</span> <span class="sy0">=</span>INSERT YOUR OTHER <span class="kw2">PRIVATE</span> <a href="http://www.php.net/key"><span class="kw3">KEY</span></a> HERE<span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">	}</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">	private function _recaptcha_qsencode ($data) {</span></div></li><li class="li1"><div class="de1"><span class="st0">		$req = &quot;</span><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		foreach ($data as $key =&gt; $value) {</span></div></li><li class="li1"><div class="de1"><span class="st0">			$req .= $key . '=' . urlencode( stripslashes($value) ) . '&amp;';</span></div></li><li class="li1"><div class="de1"><span class="st0">		}</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		// Cut the last '&amp;'</span></div></li><li class="li1"><div class="de1"><span class="st0">		$req = substr($req, 0, strlen($req) - 1);</span></div></li><li class="li1"><div class="de1"><span class="st0">		return $req;</span></div></li><li class="li1"><div class="de1"><span class="st0">	}</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">	private function _recaptcha_http_post($host, $path, $data, $port = 80) {</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		$req = $this-&gt;_recaptcha_qsencode ($data);</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		$http_request  = &quot;</span>POST <span class="st0">&quot; . $path . &quot;</span> HTTP<span class="sy0">/</span><span class="nu19">1.0</span></div></li><li class="li1"><div class="de1"><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		$http_request .= &quot;</span>Host<span class="sy0">:</span> <span class="st0">&quot; . $host . &quot;</span></div></li><li class="li1"><div class="de1"><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		$http_request .= &quot;</span>Content<span class="sy0">-</span>Type<span class="sy0">:</span> application<span class="sy0">/</span>x<span class="sy0">-</span>www<span class="sy0">-</span>form<span class="sy0">-</span>urlencoded;</div></li><li class="li1"><div class="de1"><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		$http_request .= &quot;</span>Content<span class="sy0">-</span>Length<span class="sy0">:</span> <span class="st0">&quot; . strlen($req) . &quot;</span></div></li><li class="li1"><div class="de1"><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		$http_request .= &quot;</span>User<span class="sy0">-</span>Agent<span class="sy0">:</span> reCAPTCHA<span class="sy0">/</span>PHP</div></li><li class="li1"><div class="de1"><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		$http_request .= &quot;</span></div></li><li class="li1"><div class="de1"><span class="st0">&quot;;</span></div></li><li class="li1"><div class="de1"><span class="st0">		$http_request .= $req;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		$response = '';</span></div></li><li class="li1"><div class="de1"><span class="st0">		if(false == ($fs = @fsockopen($host, $port, $errno, $errstr, 10))) {</span></div></li><li class="li1"><div class="de1"><span class="st0">			die ('Could not open socket');</span></div></li><li class="li1"><div class="de1"><span class="st0">		}</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		fwrite($fs, $http_request);</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		while (!feof($fs)) {</span></div></li><li class="li1"><div class="de1"><span class="st0">			$response .= fgets($fs, 1160); // One TCP-IP packet</span></div></li><li class="li1"><div class="de1"><span class="st0">		}</span></div></li><li class="li1"><div class="de1"><span class="st0">		fclose($fs);</span></div></li><li class="li1"><div class="de1"><span class="st0">		$response = explode(&quot;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">&quot;, $response, 2);</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">		return $response;</span></div></li><li class="li1"><div class="de1"><span class="st0">	}</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st0">	public function recaptcha_get_html ($error = null, $use_ssl = false) {</span></div></li><li class="li1"><div class="de1"><span class="st0">		if ($this-&gt;keys-&gt;recaptcha-&gt;publick == null || $this-&gt;keys-&gt;recaptcha-&gt;publick == &quot;</span><span class="st0">&quot;) {</span></div></li><li class="li1"><div class="de1"><span class="st0">			die (&quot;</span>To use reCAPTCHA you must get an API <a href="http://www.php.net/key"><span class="kw3">key</span></a> from <span class="sy0">&lt;</span>a href<span class="sy0">=</span><span class="st_h">'http://recaptcha.net/api/getkey'</span><span class="sy0">&gt;</span>http<span class="sy0">:</span><span class="co1">//recaptcha.net/api/getkey&lt;/a&gt;&quot;);</span></div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$use_ssl</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$server</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span><span class="sy0">-&gt;</span><span class="me1">RECAPTCHA_API_SECURE_SERVER</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">else</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$server</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span><span class="sy0">-&gt;</span><span class="me1">RECAPTCHA_API_SERVER</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$errorpart</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span>;</div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$error</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		   <span class="re0">$errorpart</span> <span class="sy0">=</span> <span class="st0">&quot;&amp;amp;error=&quot;</span> <span class="sy0">.</span> <span class="re0">$error</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <span class="st_h">'&lt;script type=&quot;text/javascript&quot; src=&quot;'</span><span class="sy0">.</span> <span class="re0">$server</span> <span class="sy0">.</span> <span class="st_h">'/challenge?k='</span> <span class="sy0">.</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">.</span> <span class="re0">$errorpart</span> <span class="sy0">.</span> <span class="st_h">'&quot;&gt;&lt;/script&gt;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="st_h">		&lt;noscript&gt;</span></div></li><li class="li1"><div class="de1"><span class="st_h">			&lt;iframe src=&quot;'</span><span class="sy0">.</span> <span class="re0">$server</span> <span class="sy0">.</span> <span class="st_h">'/noscript?k='</span> <span class="sy0">.</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">.</span> <span class="re0">$errorpart</span> <span class="sy0">.</span> <span class="st_h">'&quot; height=&quot;300&quot; width=&quot;500&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;br/&gt;</span></div></li><li class="li1"><div class="de1"><span class="st_h">			&lt;textarea name=&quot;recaptcha_challenge_field&quot; rows=&quot;3&quot; cols=&quot;40&quot;&gt;&lt;/textarea&gt;</span></div></li><li class="li1"><div class="de1"><span class="st_h">			&lt;input type=&quot;hidden&quot; name=&quot;recaptcha_response_field&quot; value=&quot;manual_challenge&quot;/&gt;</span></div></li><li class="li1"><div class="de1"><span class="st_h">		&lt;/noscript&gt;'</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">public</span> <span class="kw2">function</span> recaptcha_check_answer <span class="br0">&#40;</span><span class="re0">$remoteip</span><span class="sy0">,</span> <span class="re0">$challenge</span><span class="sy0">,</span> <span class="re0">$response</span><span class="sy0">,</span> <span class="re0">$extra_params</span> <span class="sy0">=</span> <a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">privatek</span> <span class="sy0">==</span> <span class="kw2">null</span> || <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">privatek</span> <span class="sy0">==</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<a href="http://www.php.net/die"><span class="kw3">die</span></a> <span class="br0">&#40;</span><span class="st0">&quot;To use reCAPTCHA you must get an API key from &lt;a href='http://recaptcha.net/api/getkey'&gt;http://recaptcha.net/api/getkey&lt;/a&gt;&quot;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$remoteip</span> <span class="sy0">==</span> <span class="kw2">null</span> || <span class="re0">$remoteip</span> <span class="sy0">==</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<a href="http://www.php.net/die"><span class="kw3">die</span></a> <span class="br0">&#40;</span><span class="st0">&quot;For security reasons, you must pass the remote ip to reCAPTCHA&quot;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="co1">//discard spam submissions</span></div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$challenge</span> <span class="sy0">==</span> <span class="kw2">null</span> || <a href="http://www.php.net/strlen"><span class="kw3">strlen</span></a><span class="br0">&#40;</span><span class="re0">$challenge</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu19">0</span> || <span class="re0">$response</span> <span class="sy0">==</span> <span class="kw2">null</span> || <a href="http://www.php.net/strlen"><span class="kw3">strlen</span></a><span class="br0">&#40;</span><span class="re0">$response</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu19">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">is_valid</span> <span class="sy0">=</span> <span class="kw2">false</span>;</div></li><li class="li1"><div class="de1">			<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">error</span> <span class="sy0">=</span> <span class="st0">&quot;incorrect_captcha_sol&quot;</span>;</div></li><li class="li1"><div class="de1">			<span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$response</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>_recaptcha_http_post <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">serverURLS</span><span class="sy0">-&gt;</span><span class="me1">RECAPTCHA_VERIFY_SERVER</span><span class="sy0">,</span> <span class="st0">&quot;/verify&quot;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">						  <a href="http://www.php.net/array"><span class="kw3">array</span></a> <span class="br0">&#40;</span></div></li><li class="li1"><div class="de1">							 <span class="st0">&quot;privatekey&quot;</span> <span class="sy0">=&gt;</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">recaptcha</span><span class="sy0">-&gt;</span><span class="me1">privatek</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">							 <span class="st0">&quot;remoteip&quot;</span> <span class="sy0">=&gt;</span> <span class="re0">$remoteip</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">							 <span class="st0">&quot;challenge&quot;</span> <span class="sy0">=&gt;</span> <span class="re0">$challenge</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">							 <span class="st0">&quot;response&quot;</span> <span class="sy0">=&gt;</span> <span class="re0">$response</span></div></li><li class="li1"><div class="de1">							 <span class="br0">&#41;</span> <span class="sy0">+</span> <span class="re0">$extra_params</span></div></li><li class="li1"><div class="de1">						  <span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$answers</span> <span class="sy0">=</span> <a href="http://www.php.net/explode"><span class="kw3">explode</span></a> <span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">\n</span>&quot;</span><span class="sy0">,</span> <span class="re0">$response</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><a href="http://www.php.net/trim"><span class="kw3">trim</span></a> <span class="br0">&#40;</span><span class="re0">$answers</span> <span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="st0">&quot;true&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">is_valid</span> <span class="sy0">=</span> <span class="kw2">true</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">else</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">is_valid</span> <span class="sy0">=</span> <span class="kw2">false</span>;</div></li><li class="li1"><div class="de1">			<span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span><span class="sy0">-&gt;</span><span class="me1">error</span> <span class="sy0">=</span> <a href="http://www.php.net/str_replace"><span class="kw3">str_replace</span></a><span class="br0">&#40;</span><span class="st0">&quot;-&quot;</span><span class="sy0">,</span> <span class="st0">&quot;_&quot;</span><span class="sy0">,</span> <span class="re0">$answers</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">ReCaptchaResponse</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span> <span class="kw2">function</span> recaptcha_get_signup_url <span class="br0">&#40;</span><span class="re0">$domain</span> <span class="sy0">=</span> <span class="kw2">null</span><span class="sy0">,</span> <span class="re0">$appname</span> <span class="sy0">=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <span class="st0">&quot;http://recaptcha.net/api/getkey?&quot;</span> <span class="sy0">.</span>  <span class="re0">$this</span><span class="sy0">-&gt;</span>_recaptcha_qsencode <span class="br0">&#40;</span><a href="http://www.php.net/array"><span class="kw3">array</span></a> <span class="br0">&#40;</span><span class="st0">&quot;domain&quot;</span> <span class="sy0">=&gt;</span> <span class="re0">$domain</span><span class="sy0">,</span> <span class="st0">&quot;app&quot;</span> <span class="sy0">=&gt;</span> <span class="re0">$appname</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span> <span class="kw2">function</span> _recaptcha_aes_pad<span class="br0">&#40;</span><span class="re0">$val</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="re0">$block_size</span> <span class="sy0">=</span> <span class="nu0">16</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$numpad</span> <span class="sy0">=</span> <span class="re0">$block_size</span> <span class="sy0">-</span> <span class="br0">&#40;</span><a href="http://www.php.net/strlen"><span class="kw3">strlen</span></a> <span class="br0">&#40;</span><span class="re0">$val</span><span class="br0">&#41;</span> <span class="sy0">%</span> <span class="re0">$block_size</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <a href="http://www.php.net/str_pad"><span class="kw3">str_pad</span></a><span class="br0">&#40;</span><span class="re0">$val</span><span class="sy0">,</span> <a href="http://www.php.net/strlen"><span class="kw3">strlen</span></a> <span class="br0">&#40;</span><span class="re0">$val</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="re0">$numpad</span><span class="sy0">,</span> <a href="http://www.php.net/chr"><span class="kw3">chr</span></a><span class="br0">&#40;</span><span class="re0">$numpad</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="coMULTI">/* Mailhide related code */</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span> <span class="kw2">function</span> _recaptcha_aes_encrypt<span class="br0">&#40;</span><span class="re0">$val</span><span class="sy0">,</span><span class="re0">$ky</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span><a href="http://www.php.net/function_exists"><span class="kw3">function_exists</span></a> <span class="br0">&#40;</span><span class="st0">&quot;mcrypt_encrypt&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<a href="http://www.php.net/die"><span class="kw3">die</span></a> <span class="br0">&#40;</span><span class="st0">&quot;To use reCAPTCHA Mailhide, you need to have the mcrypt php module installed.&quot;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="re0">$mode</span> <span class="sy0">=</span> MCRYPT_MODE_CBC;</div></li><li class="li1"><div class="de1">		<span class="re0">$enc</span> <span class="sy0">=</span> MCRYPT_RIJNDAEL_128;</div></li><li class="li1"><div class="de1">		<span class="re0">$val</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>_recaptcha_aes_pad<span class="br0">&#40;</span><span class="re0">$val</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> mcrypt_encrypt<span class="br0">&#40;</span><span class="re0">$enc</span><span class="sy0">,</span> <span class="re0">$ky</span><span class="sy0">,</span> <span class="re0">$val</span><span class="sy0">,</span> <span class="re0">$mode</span><span class="sy0">,</span> <span class="st0">&quot;<span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span><span class="es0">\0</span>&quot;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span> <span class="kw2">function</span> _recaptcha_mailhide_urlbase64 <span class="br0">&#40;</span><span class="re0">$x</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <a href="http://www.php.net/strtr"><span class="kw3">strtr</span></a><span class="br0">&#40;</span><a href="http://www.php.net/base64_encode"><span class="kw3">base64_encode</span></a> <span class="br0">&#40;</span><span class="re0">$x</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;+/&quot;</span><span class="sy0">,</span> <span class="st0">&quot;-_&quot;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="coMULTI">/* gets the reCAPTCHA Mailhide url for a given email, public key and private key */</span></div></li><li class="li1"><div class="de1">	<span class="kw2">public</span> <span class="kw2">function</span> recaptcha_mailhide_url<span class="br0">&#40;</span><span class="re0">$email</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">==</span> <span class="st0">&quot;&quot;</span> || <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">==</span> <span class="kw2">null</span> || <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">privatek</span> <span class="sy0">==</span> <span class="st0">&quot;&quot;</span> || <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">privatek</span> <span class="sy0">==</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<a href="http://www.php.net/die"><span class="kw3">die</span></a> <span class="br0">&#40;</span><span class="st0">&quot;To use reCAPTCHA Mailhide, you have to sign up for a public and private key, &quot;</span> <span class="sy0">.</span></div></li><li class="li1"><div class="de1">			     <span class="st0">&quot;you can do so at &lt;a href='http://mailhide.recaptcha.net/apikey'&gt;http://mailhide.recaptcha.net/apikey&lt;/a&gt;&quot;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="re0">$ky</span> <span class="sy0">=</span> <a href="http://www.php.net/pack"><span class="kw3">pack</span></a><span class="br0">&#40;</span><span class="st_h">'H*'</span><span class="sy0">,</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">privatek</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$cryptmail</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>_recaptcha_aes_encrypt <span class="br0">&#40;</span><span class="re0">$email</span><span class="sy0">,</span> <span class="re0">$ky</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <span class="st0">&quot;http://mailhide.recaptcha.net/d?k=&quot;</span> <span class="sy0">.</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">keys</span><span class="sy0">-&gt;</span><span class="me1">mailhide</span><span class="sy0">-&gt;</span><span class="me1">publick</span> <span class="sy0">.</span> <span class="st0">&quot;&amp;c=&quot;</span> <span class="sy0">.</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>_recaptcha_mailhide_urlbase64 <span class="br0">&#40;</span><span class="re0">$cryptmail</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">private</span> <span class="kw2">function</span> _recaptcha_mailhide_email_parts <span class="br0">&#40;</span><span class="re0">$email</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="re0">$arr</span> <span class="sy0">=</span> <a href="http://www.php.net/preg_split"><span class="kw3">preg_split</span></a><span class="br0">&#40;</span><span class="st0">&quot;/@/&quot;</span><span class="sy0">,</span> <span class="re0">$email</span> <span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="kw1">if</span> <span class="br0">&#40;</span><a href="http://www.php.net/strlen"><span class="kw3">strlen</span></a> <span class="br0">&#40;</span><span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">&lt;=</span> <span class="nu0">4</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="http://www.php.net/substr"><span class="kw3">substr</span></a> <span class="br0">&#40;</span><span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="nu19">0</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span><a href="http://www.php.net/strlen"><span class="kw3">strlen</span></a> <span class="br0">&#40;</span><span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">&lt;=</span> <span class="nu0">6</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="http://www.php.net/substr"><span class="kw3">substr</span></a> <span class="br0">&#40;</span><span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="nu19">0</span><span class="sy0">,</span> <span class="nu0">3</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">else</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">			<span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span> <span class="sy0">=</span> <a href="http://www.php.net/substr"><span class="kw3">substr</span></a> <span class="br0">&#40;</span><span class="re0">$arr</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="nu19">0</span><span class="sy0">,</span> <span class="nu0">4</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <span class="re0">$arr</span>;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="kw2">public</span> <span class="kw2">function</span> recaptcha_mailhide_html<span class="br0">&#40;</span><span class="re0">$email</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">		<span class="re0">$emailparts</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span>_recaptcha_mailhide_email_parts <span class="br0">&#40;</span><span class="re0">$email</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">		<span class="re0">$url</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">recaptcha_mailhide_url</span> <span class="br0">&#40;</span><span class="re0">$email</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">		<span class="kw1">return</span> <a href="http://www.php.net/htmlentities"><span class="kw3">htmlentities</span></a><span class="br0">&#40;</span><span class="re0">$emailparts</span><span class="br0">&#91;</span><span class="nu19">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">.</span> <span class="st0">&quot;&lt;a href=<span class="es0">\&quot;</span>&quot;</span> <span class="sy0">.</span> <a href="http://www.php.net/htmlentities"><span class="kw3">htmlentities</span></a> <span class="br0">&#40;</span><span class="re0">$url</span><span class="br0">&#41;</span> <span class="sy0">.</span></div></li><li class="li1"><div class="de1">			<span class="st0">&quot;<span class="es0">\&quot;</span> onclick=<span class="es0">\&quot;</span>window.open('&quot;</span> <span class="sy0">.</span> <a href="http://www.php.net/htmlentities"><span class="kw3">htmlentities</span></a> <span class="br0">&#40;</span><span class="re0">$url</span><span class="br0">&#41;</span> <span class="sy0">.</span> <span class="st0">&quot;', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;<span class="es0">\&quot;</span> title=<span class="es0">\&quot;</span>Reveal this e-mail address<span class="es0">\&quot;</span>&gt;...&lt;/a&gt;@&quot;</span> <span class="sy0">.</span> <a href="http://www.php.net/htmlentities"><span class="kw3">htmlentities</span></a> <span class="br0">&#40;</span><span class="re0">$emailparts</span> <span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">	<span class="br0">&#125;</span></div></li><li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">/*</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">$recaptcha = new recaptcha();</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">$error = null;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">if ($_POST[&quot;recaptcha_response_field&quot;]) {</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">	$resp = $recaptcha-&gt;recaptcha_check_answer (</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">				$_SERVER[&quot;REMOTE_ADDR&quot;],</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">				$_POST[&quot;recaptcha_challenge_field&quot;],</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">				$_POST[&quot;recaptcha_response_field&quot;]</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">			);</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">	if ($resp-&gt;is_valid) {</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">		echo &quot;You got it!&quot;;</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">	} else {</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">		# set the error code so that we can display it</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">		$error = $resp-&gt;error;</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">	}</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">} else {}</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">echo $recaptcha-&gt;recaptcha_get_html($error);</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">The Mailhide version of example@example.com is</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">&nbsp;echo $recaptcha-&gt;recaptcha_mailhide_html (&quot;example@example.com&quot;);</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="coMULTI">The url for the email is:</span></div></li><li class="li1"><div class="de1"><span class="coMULTI">&nbsp;echo $recaptcha-&gt;recaptcha_mailhide_url (&quot;example@example.com&quot;); */</span></div></li><li class="li1"><div class="de1"><span class="kw2">?&gt;</span></div></li></ol></pre>						</div>

										</div>

					<p>
					    <span class="rgt" id="spam">
					        <a href="#" onclick="alert('You must be logged in to report a snippet.');return false;" title="Use this to report spam">Report this snippet</a>
					    </span>
					    &nbsp;
					    <span class="rgt">
					        <a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="snipplr">Tweet</a>
					    </span>
					</p>

					

										<div id="snippetcomment">
											<p><label for="comment">Comment:</label></p>
						<p><textarea name="comment" id="comment" rows="8" cols="40" class="inactive"></textarea></p>
					<div id="message"><p>You need to <a href='/login/'>login</a> to post a comment.</p></div>
										</div>
				</div>
		<div class="clear"></div>
	</div>
	</div>

<div id="footernav">
	<div class="container">
		<ul>
			<li><a href="/" class="first">Code Snippets</a>/</li>
			
			<li><a href="/developer/">Extras</a>/</li>

			<li><a href="/blog/">Snipplr Blog</a>/</li>
			
			<li><a href="/about/">About Snipplr</a></li>
			
			
		</ul>
	</div>
</div>

<div class="container" id="footer">
	<h3>Choose a language for easy browsing:</h3>
	<ul class="languages">
		<li><a href="/all/language/actionscript">ActionScript</a></li>
<li><a href="/all/language/actionscript-3">ActionScript 3</a></li>
<li><a href="/all/language/apache">Apache</a></li>
<li><a href="/all/language/applescript">AppleScript</a></li>
<li><a href="/all/language/asp">ASP</a></li>
<li><a href="/all/language/assembler">Assembler</a></li>
<li><a href="/all/language/autoit">AutoIt</a></li>
<li><a href="/all/language/awk">Awk</a></li>
<li><a href="/all/language/bash">Bash</a></li>
<li><a href="/all/language/c">C</a></li>
<li><a href="/all/language/c-sharp">C#</a></li>
<li><a href="/all/language/c-plus-plus">C++</a></li>
<li><a href="/all/language/clojure">Clojure</a></li>
<li><a href="/all/language/cold-fusion">ColdFusion</a></li>
<li><a href="/all/language/css">CSS</a></li>
<li><a href="/all/language/delphi">Delphi</a></li>
<li><a href="/all/language/diff">Diff</a></li>
<li><a href="/all/language/django">Django</a></li>
<li><a href="/all/language/dos">DOS Batch</a></li>
<li><a href="/all/language/emacs-lisp">Emacs Lisp</a></li>
<li><a href="/all/language/ez-publish">eZ Publish</a></li>
<li><a href="/all/language/forth">Forth</a></li>
<li><a href="/all/language/fortran">Fortran</a></li>
<li><a href="/all/language/gnuplot">Gnuplot</a></li>
<li><a href="/all/language/groovy">Groovy</a></li>
<li><a href="/all/language/haml">HAML</a></li>
<li><a href="/all/language/haskell">Haskell</a></li>
<li><a href="/all/language/html">HTML</a></li>
<li><a href="/all/language/iphone">iPhone</a></li>
<li><a href="/all/language/java">Java</a></li>
<li><a href="/all/language/javascript">JavaScript</a></li>
<li><a href="/all/language/jquery">jQuery</a></li>
<li><a href="/all/language/latex">LaTeX</a></li>
<li><a href="/all/language/lighttpd">lighttpd</a></li>
<li><a href="/all/language/lisp">Lisp</a></li>
<li><a href="/all/language/lua">Lua</a></li>
<li><a href="/all/language/make">Makefile</a></li>
<li><a href="/all/language/matlab">MatLab</a></li>
<li><a href="/all/language/maxscript">Maxscript</a></li>
<li><a href="/all/language/mel">Mel</a></li>
<li><a href="/all/language/mxml">MXML</a></li>
<li><a href="/all/language/mysql">MySQL</a></li>
<li><a href="/all/language/newtonscript">NewtonScript</a></li>
<li><a href="/all/language/objective-c">Objective C</a></li>
<li><a href="/all/language/open-firmware">Open Firmware</a></li>
<li><a href="/all/language/other">Other</a></li>
<li><a href="/all/language/pascal">Pascal</a></li>
<li><a href="/all/language/perl">Perl</a></li>
<li><a href="/all/language/php">PHP</a></li>
<li><a href="/all/language/picbasic">PicBasic</a></li>
<li><a href="/all/language/plsql">PL/SQL</a></li>
<li><a href="/all/language/processing">Processing</a></li>
<li><a href="/all/language/prolog">Prolog</a></li>
<li><a href="/all/language/pseudocode">Pseudocode</a></li>
<li><a href="/all/language/python">Python</a></li>
<li><a href="/all/language/r">R</a></li>
<li><a href="/all/language/rails">Rails</a></li>
<li><a href="/all/language/regex">Regular Expression</a></li>
<li><a href="/all/language/revolution">Revolution</a></li>
<li><a href="/all/language/ruby">Ruby</a></li>
<li><a href="/all/language/sas">SAS</a></li>
<li><a href="/all/language/sass">SASS</a></li>
<li><a href="/all/language/scala">Scala</a></li>
<li><a href="/all/language/scheme">Scheme</a></li>
<li><a href="/all/language/smalltalk">SmallTalk</a></li>
<li><a href="/all/language/smarty">Smarty</a></li>
<li><a href="/all/language/sml">SML</a></li>
<li><a href="/all/language/spss">SPSS</a></li>
<li><a href="/all/language/sql">SQL</a></li>
<li><a href="/all/language/svn">SVN</a></li>
<li><a href="/all/language/symfony">Symfony</a></li>
<li><a href="/all/language/tcl">TCL</a></li>
<li><a href="/all/language/textpattern">Textpattern</a></li>
<li><a href="/all/language/typo3">TYPO3</a></li>
<li><a href="/all/language/vbnet">VB.NET</a></li>
<li><a href="/all/language/vhdl">VHDL</a></li>
<li><a href="/all/language/visual-basic">Visual Basic</a></li>
<li><a href="/all/language/w-language">W-Language</a></li>
<li><a href="/all/language/windows-powershell">Windows PowerShell</a></li>
<li><a href="/all/language/windows-registry">Windows Registry</a></li>
<li><a href="/all/language/xhtml">XHTML</a></li>
<li><a href="/all/language/xml">XML</a></li>
<li><a href="/all/language/xslt">XSLT</a></li>
	</ul>
	<br /><br />
</div>

<script type="text/javascript">
	// Google Analytics
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-11834194-28']);
	_gaq.push(['_trackPageview']);
	
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>

</body>
</html>