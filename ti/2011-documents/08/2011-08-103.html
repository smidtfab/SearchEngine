<!DOCTYPE html>










 



 

 

 































































  
  
                           
  


<html>
  <head>
    
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Using reCAPTCHA with ASP.NET - reCAPTCHA - Google Code</title>
<script type="text/javascript"><!--
(function(){function a(){this.t={};this.tick=function(c){this.t[c]=(new Date).getTime()};this.tick("start")}var b=new a;window.jstiming={Timer:a,load:b};if(window.external&&window.external.pageT)window.jstiming.pt=window.external.pageT;})();

var _tocPath_ = '/apis/recaptcha/_toc.ezt';
var codesite_token = null;
var logged_in_user_email = null;
//--></script>
<link href="/css/codesite.pack.04102009.css" type="text/css" rel="stylesheet">
<script src="/js/codesite_head.pack.04102009.js" type="text/javascript"></script>
<script type="text/javascript">CODESITE_CSITimer['load'].tick('bhs');</script>
<link rel="search" type="application/opensearchdescription+xml" title="Google Code" href="/osd.xml">

<!--[if IE]><link rel="stylesheet" type="text/css" href="/css/iehacks.css"><![endif]-->

    <link href="/css/semantic_headers.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="gc-documentation">

    
    
    <div id="gb">
 <span>
  
   
    <a href="#"
       id="projects-dropdown" onclick="return false;"
       ><span style="text-decoration:underline">My favorites</span> <span style="font-size:.75em;">&#9660;</span></a>
    |
  
    <a id="lang-dropdown" href="/" onclick="return false;"><span style="text-decoration:underline">English</span> <span style="font-size:.75em;">&#9660;</span></a>
  
   
    | <a href="https://www.google.com/accounts/Login?continue=http%3A%2F%2Fcode.google.com%2Fapis%2Frecaptcha%2Fdocs%2Faspnet.html&amp;followup=http%3A%2F%2Fcode.google.com%2Fapis%2Frecaptcha%2Fdocs%2Faspnet.html" onclick="CODESITE_click('/gb/sc/signin');"><span style="style:text-decoration:underline">Sign in</span></a>
   
  
 </span>
</div>

<div class="gbh" style="left:0px;"></div>
<div class="gbh" style="right:0px;"></div>

<div id="gc-container" class="labs">
<a id="top"></a>
<div id="skipto">
  <a href="#gc-pagecontent">Skip to page content</a>
  <a href="#gc-toc">Skip to main navigation</a>
</div>

<div id="gc-header">
  <div id="logo"><a href="/">
  
  
     <img src="/images/code_labs_logo.gif" height="40" width="167" alt="Google Code Labs" style="border:0;">
  
  
  </a></div>
  <div id="search">
    <div id="searchForm">
      <form id="cse" action="http://www.google.com/cse" accept-charset="utf-8" onsubmit="executeGSearch(document.getElementById('gsearchInput').value); return false;">
      <noscript>
      <input type="hidden" name="cref" value="http://code.google.com/cse/googlecode-context.xml">
      </noscript>
      <div id="gsc-search-box">
        <input id="gsearchInput" type="text" name="q" maxlength="2048" class="gsc-input" autocomplete="off" title="Google Code Search" style="width:345px">
        <div id="cs-searchresults" onclick="event.cancelBubble = true;"></div>
        <input title="Search" id="gsearchButton" class="gsc-search-button" name="sa" value="Search" type="submit">
        <div class="greytext">e.g. "adwords" or "open source"</div>
      </div>
      </form>
    </div> <!-- end searchForm -->
  </div> <!-- end search -->




</div> <!-- end gc-header -->


<div id="codesiteContent">

<a id="gc-topnav-anchor"></a>
<div id="gc-topnav">
  <h1 style="padding:0 0 0 6px;">reCAPTCHA (<a href="/labs/">Labs</a>)</h1>
  <ul id="docs" class="gc-topnav-tabs">

    <li id="home_link">
      <a href="/apis/recaptcha/" title="reCAPTCHA home page">Home</a>
    </li>
  
    <li id="docs_link">
      <a href="/apis/recaptcha/intro.html" class="selected" title="Official reCAPTCHA documentation">Docs</a>
    </li>
  
    <li id="faq_link">
      <a href="/apis/recaptcha/docs/troubleshooting.html" title="Answers to frequently asked questions about reCAPTCHA">FAQ</a>
    </li>
  
    <li>
      <a href="http://groups.google.com/group/recaptcha" title="reCAPTCHA developer forum">Forum</a>
    </li>
  

  </ul>
</div> <!-- end gc-topnav -->

    <div class="g-section g-tpl-170">

      <div class="g-unit g-first" id="gc-toc">
        <ul>
  <li><a href="https://www.google.com/recaptcha/admin/create">Sign up for an API key</a></li>
</ul>
<div class="line"></div>
<ul>
  <li><h2>Documentation</h2>
    <ul>
      <li><a href="/apis/recaptcha/intro.html">Introduction</a></li>
      <li><a href="/apis/recaptcha/docs/display.html">Display Without Plugins</a></li>
      <li><a href="/apis/recaptcha/docs/verify.html">Verify Without Plugins</a></li>
      <li><a href="/apis/recaptcha/docs/customization.html">Customization</a></li>
      <li><a href="/apis/recaptcha/docs/tips.html">Tips and Guidelines</a></li>
      <li><a href="/apis/recaptcha/docs/troubleshooting.html">Troubleshooting</a></li>
               <ul>
                 <li><h2 class="tlw-expanded">Plugins:</h2>
                    <ul>
                      <li><a href="/apis/recaptcha/docs/php.html">PHP</a></li>
                      <li><a href="/apis/recaptcha/docs/aspnet.html">ASP.NET</a></li>
                      <li><a href="/apis/recaptcha/docs/asp.html">Classic ASP</a></li>
                      <li><a href="/apis/recaptcha/docs/java.html">Java/JSP</a></li>
                      <li><a href="/apis/recaptcha/docs/perl.html">Perl</a></li>
                      <li><a href="/apis/recaptcha/docs/wordpress.html">WordPress</a></li>
                      <li><a href="/apis/recaptcha/docs/mediawiki.html">MediaWiki</a></li>
                      <li><a href="/apis/recaptcha/docs/phpbb.html">phpBB</a></li>
                      <li><a href="/apis/recaptcha/docs/formmail.html">FormMail</a></li>
                      <li><a href="/apis/recaptcha/docs/otherplatforms.html">Other Platforms</a></li>
                    </ul></li>
                </ul>
      <li><a href="/apis/recaptcha/docs/mailhideapi.html">Mailhide API</a></li>
    </ul>
  </li>
</ul>

        <a class="hidden" href="#gc-topnav-anchor">More reCAPTCHA resource links</a>
      </div>

      <div class="g-unit" id="gc-pagecontent">
        <script type="text/javascript">CODESITE_docEarlyProcessing();</script>


        <h1 class="page_title">Using reCAPTCHA with ASP.NET</h1>


<p>The reCAPTCHA ASP.NET Library provides a simple way to place a
<a href="http://www.google.com/recaptcha/captcha">CAPTCHA</a> on your ASP.NET website, helping you stop bots
from abusing it. The library wraps the <a href="/apis/recaptcha/intro.html">reCAPTCHA API</a>.
You can use the library from any .NET language including C# and Visual Basic .NET.</p>


<p>To use reCAPTCHA with ASP.NET, you can download the <a
href="http://code.google.com/p/recaptcha/downloads/list?q=label:aspnetlib-Latest">reCAPTCHA
ASP.NET library</a>.</p>

<h2>Quick Start</h2>

<p>After you've signed up for your API keys, below are basic instructions for installing
reCAPTCHA on your site with ASP.NET:</p>

<ol>
<li>Add a reference on your website to library/bin/Release/Recaptcha.dll: On the Visual Studio
Website menu, choose Add Reference and then click the .NET tab in the dialog box. Select the
Recaptcha.dll component from the list of .NET components and then click OK. If you don't see
the component, click the Browse tab and look for the assembly file on your hard drive.</li>
<li>Insert the reCAPTCHA control into the form you wish to protect by adding the following code snippets:

<p>At the top of the aspx page, insert this:</p>

<pre class="prettyprint">
  &lt;%@ Register TagPrefix="recaptcha" Namespace="Recaptcha" Assembly="Recaptcha" %&gt;
</pre>

<p>Then insert the reCAPTCHA control inside of the &lt;form runat="server"&gt; tag:</p>

<pre class="prettyprint">
  &lt;recaptcha:RecaptchaControl
    ID="recaptcha"
    runat="server"
    PublicKey="<font color=red>your_public_key</font>"
    PrivateKey="<font color=red>your_private_key</font>"
    /&gt;
</pre>

<p>You will need to substitute your public and private key into PublicKey and PrivateKey respectively.</p></li>

<li>Make sure you use ASP.NET validation to validate your form (you should check Page.IsValid on submission).</li>
</ol>

<p>The following is a "Hello World" with reCAPTCHA using Visual Basic. A C# sample is
included with the library download.</p>

<pre class="prettyprint">
  &lt;%@ Page Language="VB" %&gt;
  &lt;%@ Register TagPrefix="recaptcha" Namespace="Recaptcha" Assembly="Recaptcha" %&gt;
  &lt;script runat=server%gt;
      Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs)
          If Page.IsValid Then
              lblResult.Text = "You Got It!"
              lblResult.ForeColor = Drawing.Color.Green
          Else
              lblResult.Text = "Incorrect"
              lblResult.ForeColor = Drawing.Color.Red
          End If
      End Sub
  &lt;/script&gt;
  &lt;html&gt;
  &lt;body&gt;
      &lt;form runat="server"&gt;
          &lt;asp:Label Visible=false ID="lblResult" runat="server" /&gt;
          &lt;recaptcha:RecaptchaControl
              ID="recaptcha"
              runat="server"
              Theme="red"
              PublicKey="<font color=red>your_public_key</font>"
              PrivateKey="<font color=red>your_private_key</font>"
              /&gt;

          &lt;asp:Button ID="btnSubmit" runat="server" Text="Submit" OnClick="btnSubmit_Click" /&gt;
      &lt;/form&gt;
  &lt;/body&gt;
  &lt;/html&gt;
</pre>

<h3>Further Reading</h3>

<li><a href="customization.html">Customizing Look and Feel</a></li>
<li><a href="tips.html">Tips and Guidelines</a></li>
<li><a href="troubleshooting.html">Troubleshooting</a></li>


      </div><!-- end gc-pagecontent -->
   </div><!-- end gooey wrapper -->

    </div> <!-- end codesite content -->


<div id="gc-footer" dir="ltr">
  <div class="text">
    
    Â©2011 Google -
    <a href="/">Code Home</a> -
    <a href="/terms.html">Terms of Service</a> -
    <a href="/privacy.html">Privacy Policy</a> -
    <a href="/more/">Site Directory</a>
    <br> <br>
    Google Code offered in:
    <a href="/intl/en/">English</a> -
    <a href="/intl/es/">EspaÃ±ol</a> -
    <a href="/intl/ja/">æ¥æ¬èª</a> -
    <a href="/intl/ko/">íêµ­ì´</a> -
    <a href="/intl/pt-BR/">PortuguÃªs</a> -
    <a href="/intl/ru/">PÑÑÑÐºÐ¸Ð¹</a> -
    <a href="/intl/zh-CN/">ä¸­æ(ç®ä½)</a> -
    <a href="/intl/zh-TW/">ä¸­æ(ç¹é«)</a>
  </div>
</div><!-- end gc-footer -->

</div><!-- end gc-container -->

<script type="text/javascript">CODESITE_CSITimer['load'].tick('ats');</script>
<script src="/js/codesite_tail.pack.04102009.js" type="text/javascript"></script>




<script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(


    ['siteTracker._setAccount', 'UA-18071-1'],
    ['siteTracker._setDomainName', 'code.google.com'],
    ['siteTracker._setCookiePath', window.location.pathname.substring(0,
        window.location.pathname.lastIndexOf('/') + 1)],
    ['siteTracker._trackPageview']
);
(function() {
  var ga = document.createElement('script');

  ga.type = 'text/javascript';
  ga.async = true;
  ga.src = 'http://www.google-analytics.com/ga.js';
  (document.getElementsByTagName('head')[0] ||
   document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
</script>




  </body>
</html>

